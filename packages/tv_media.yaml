automation:
  - alias: hdmi_input_select
    id: '9559814521978'
    mode: parallel
    trigger:
      - platform: state
        entity_id: input_select.hdmi
      - platform: state
        entity_id: input_select.hdmi2
    action:
      - service: media_player.select_source
        data:
          entity_id: >
            {% if trigger.entity_id == 'input_select.hdmi' %}
              media_player.sony_kd_55xe9305
            {% elif trigger.entity_id == 'input_select.hdmi2' %}
              media_player.samsung_tv
            {% endif %}
          source: >
            {{ states(trigger.entity_id) }}

  - id: '1613995690500'
    alias: Mute Spotify Ads
    description: ''
    use_blueprint:
      path: homeassistant/mute_spotify_ads.yaml
      input:
        mediaplayer_entity: media_player.nest_mini

  - id: mute_ads
    alias: Mute Ads
    description: Mute ads while streaming music
    trigger:
    - platform: state
      entity_id:
      - media_player.nvidia_shield
      - media_player.plex_plex_for_android_tv_shield_android_tv
      - media_player.spotify_anarion
      - media_player.nest_mini
      - media_player.kd_55xe9305
      - media_player.sony_kd_55xe9305
      - media_player.chromecastaudio
      attribute: media_title
      to: Advertisement
    action:
    - service: media_player.volume_mute
      target:
        entity_id: '{{ trigger.to_state.entity_id }}

          '
      data:
        is_volume_muted: true
    - wait_for_trigger:
        platform: state
        entity_id:
        - media_player.nvidia_shield
        - media_player.plex_plex_for_android_tv_shield_android_tv
        - media_player.spotify_anarion
        - media_player.nest_mini
        - media_player.kd_55xe9305
        - media_player.sony_kd_55xe9305
        - media_player.chromecastaudio
        attribute: media_title
        from: Advertisement
    - service: media_player.volume_mute
      target:
        entity_id: '{{ trigger.to_state.entity_id }}

          '
      data:
        is_volume_muted: false

binary_sensor:
  - platform: command_line
    name: plex_availability
    command: !secret plex_availability
    scan_interval: 300

homeassistant:
  customize:
  #media_player
    media_player.sony_kd_55xe9305:
      friendly_name: TV
      device_class: tv
      source_list: ['HDMI 1', 'HDMI 2/MHL', 'HDMI 3', 'HDMI 4']
    media_player.samsung_tv:
      friendly_name: "Tv\u00B2"
      device_class: tv
      source_list: ['TV', 'HDMI']
    media_player.spotify_anarion:
      friendly_name: Spotify
    media_player.nest_mini:
      friendly_name: Google Nest Mini

  # template
    select.hdmi_bravia:
      friendly_name: Source
      icon: custom:hdmi-source

input_boolean:
  radio_status:
    name: Radio is on
    icon: mdi:radio
  chromecast_audio_status:
    name: Chromecast Audio is on
    icon: mdi:cast-audio

input_select:
  hdmi:
    name: Żródło
    options:
      - HDMI 1
      - HDMI 2/MHL
      - HDMI 3
      - HDMI 4
      - TVP1 HD
      - TVP2 HD
      - TVP3 Krakow
      - Polsat
      - TVN
      - TV4
      - TV Puls
      - TVN 7
      - PULS 2
      - TV6
      - Super Polsat
      - ESKA TV
      - TTV
      - Polo TV
      - SILVER TV
      - TV Trwam
      - Stopklatka TV
      - Fokus TV
      - TVP ABC
      - TVP Kultura HD
      - TVP Historia
      - TVP Sport HD
      - TVP Info
      - TVP Kobieta
      - Metro
      - Zoom TV
      - Nowa TV
      - WP
      - TVP 4K
      - eSZKOLA DOMOWE PRZEDSZKOLE
      - Telewizja Naziemna
      - TVP Kultura 2
      - EmiTV
      - TOYAcyfrowaINFO
    initial: HDMI 1
    icon: mdi:video-input-hdmi

  hdmi2:
    name: Źródło
    options:
      - TV
      - HDMI
    initial: HDMI
    icon: custom:hdmi-source

  tv_channels:
    name: Kanały TV
    options:
      - TVP1 HD
      - TVP2 HD
      - TVP3 Krakow
      - Polsat
      - TVN
      - TV4
      - TV Puls
      - TVN 7
      - PULS 2
      - TV6
      - Super Polsat
      - ESKA TV
      - TTV
      - Polo TV
      - SILVER TV
      - TV Trwam
      - Stopklatka TV
      - Fokus TV
      - TVP ABC
      - TVP Kultura HD
      - TVP Historia
      - TVP Sport HD
      - TVP Info
      - TVP Kobieta
      - Metro
      - Zoom TV
      - Nowa TV
      - WP
      - eSZKOLA DOMOWE PRZEDSZKOLE
      - Telewizja Naziemna
      - TVP Kultura 2
      - EmiTV
      - TOYAcyfrowaINFO
    initial: TVP1 HD
    icon: mdi:television-classic

  radio_station:
    initial: RMF Classic
    options:
      - Rock Radio
      - Antyradio
      - RMF Classic
      - RMF FM
      - Nowy Świat

  player:
    initial: Google Nest
    options:
      - Google Nest
      - Chromecast Audio

group:
  living_room_media_players:
    name: Living Room Media Players
    entities:
      - media_player.chromecastaudio
      - media_player.shield
      - media_player.nvidia_shield
      - media_player.nest_mini
      - media_player.kd_55xe9305
      - media_player.sony_kd_55xe9305
      - media_player.spotify_anarion

template:
  - select:
      - name: conditional_media
        state: >
          {% set recently_added = 'Last added' %}
          {% set paused_timeout_minutes = 15 %}
          {% set media_players = [
            states.media_player.chromecastaudio,
            states.media_player.kd_55xe9305,
            states.media_player.nest_mini,
            states.media_player.plex_plex_for_android_tv_shield_android_tv,
            states.media_player.plex_plexamp_android,
            states.media_player.sony_kd_55xe9305,
            states.media_player.spotify_anarion,
            states.sensor.netflix_on_shield ] %}
          {% macro media(state) %}
          {% set state = media_players | selectattr('state','eq',state) | list %}
          {% set last_changed = recently_added if state | length == 0 else state | map(attribute='last_changed') | list | max %}
            {{ state | selectattr('last_changed','eq', last_changed) | map(attribute='name') | list | join }}
          {% endmacro %}
          {% set playing = media_players | selectattr('state','eq','playing') | list %}
          {% set timeout_playing = False if playing | length == 0 else
            (as_timestamp(now()) - as_timestamp(playing | map(attribute='last_changed') | list | max)) < paused_timeout_minutes * 60 %}
          {% set paused = media_players | selectattr('state','eq','paused') | list %}
          {% set timeout_paused = False if paused | length == 0 else
            (as_timestamp(now()) - as_timestamp(paused | map(attribute='last_changed') | list | max)) < paused_timeout_minutes * 60 %}
          {% if playing %}
            {{ media('playing') if timeout_playing else media('paused') if timeout_paused else media('playing') }}
          {% elif paused %}
            {{ media('paused') if timeout_paused else recently_added }}
          {% else %}
            {{ recently_added }}
          {% endif %}
        options: >
          {% set recently_added = ['Last added'] %}
          {% set media_players = [
            states.media_player.chromecastaudio,
            states.media_player.kd_55xe9305,
            states.media_player.nest_mini,
            states.media_player.plex_plex_for_android_tv_shield_android_tv,
            states.media_player.plex_plexamp_android,
            states.media_player.sony_kd_55xe9305,
            states.media_player.spotify_anarion,
            states.sensor.netflix_on_shield ] %}
          {{ recently_added + media_players | map(attribute='name') | list }}
        select_option:
          service: select.select_option
          target:
            entity_id: select.conditional_media
          data:
            option: >
              {{ option }}

      - name: hdmi_bravia
        state: >
          {% set source = state_attr('media_player.sony_kd_55xe9305', 'source') %}
          {{ iif(source == None, 'HDMI3', source) }}
        options: >
          {% set source_list = state_attr('media_player.sony_kd_55xe9305', 'source_list') %}
          {{ iif(source_list == None, ['HDMI3'], source_list) }}
        select_option:
          service: media_player.select_source
          target:
            entity_id: media_player.sony_kd_55xe9305
          data:
            source: >
              {{ option }}

  - sensor:
      - name: "Netflix on Shield"
        state: >
          {% set player = states.media_player.nvidia_shield.state %}
          {% if player == 'playing' and state_attr('media_player.nvidia_shield', 'source') == 'Netflix'  %}
            playing
          {% elif (player == 'paused' or player == 'standby') and state_attr('media_player.nvidia_shield', 'source') == 'Netflix' %}
            paused
          {% else %}
            idle
          {% endif %}
        attributes:
          media_artist: >
            {% set player = states.media_player.nvidia_shield.state %}
            {% if player == 'playing' and state_attr('media_player.nvidia_shield', 'source') == 'Netflix'  %}
              Netflix
            {% elif (player == 'paused' or player == 'standby') and state_attr('media_player.nvidia_shield', 'source') == 'Netflix' %}
              Netflix
            {% else %}
            {% endif %}
          media_title: >
            {% set player = states.media_player.nvidia_shield.state %}
            {% if player == 'playing' and state_attr('media_player.nvidia_shield', 'source') == 'Netflix'  %}
              Netflix
            {% elif (player == 'paused' or player == 'standby') and state_attr('media_player.nvidia_shield', 'source') == 'Netflix' %}
              Netflix
            {% else %}
            {% endif %}
          entity_picture: "/local/netflix-logo2.jpg"


sensor:
  - platform: plex_recently_added
    token: !secret plex_token
    host: !secret plex_host
    port: !secret plex_port
    max: 1
    img_dir: /
    image_resolution: 900

  - platform: template
    sensors:
      tv_channel:
        unique_id: current_tv_channel
        friendly_name: Current TV Channel
        value_template: >
          {%- set all_channels = ['TVP1 HD', 'TVP2 HD', 'TVP3 Krakow', 'Polsat', 'TVN', 'TV4', 'TV Puls', 'TVN 7', 'PULS 2', 'TV6', 'Super Polsat', 'ESKA TV', 'TTV', 'Polo TV', 'SILVER TV', 'TV Trwam', 'Stopklatka TV', 'Fokus TV', 'TVP ABC', 'TVP Kultura HD', 'TVP Historia', 'TVP Sport HD', 'TVP Info', 'TVP Kobieta', 'Metro', 'Zoom TV', 'Nowa TV', 'WP', 'eSZKOLA DOMOWE PRZEDSZKOLE', 'Telewizja Naziemna', 'TVP Kultura 2', 'EmiTV', 'TOYAcyfrowaINFO'] %}
          {{ state_attr('media_player.sony_kd_55xe9305','source') }}
      czas_tv:
        friendly_name: Czas działania TV
        value_template: >
          {% if (states('sensor.czas_dzialania_tv') == "unavailable") or (states('sensor.czas_dzialania_tv') == "unknown") %}
          0
          {% else %}
          {{states('sensor.czas_dzialania_tv')}}
          {% endif %}
        unit_of_measurement: "h"

  - platform: history_stats
    name: Czas działania TV
    entity_id: media_player.sony_kd_55xe9305
    state: "on"
    type: time
    start: "{{ now().replace(hour=0, minute=0, second=0) }}"
    end: "{{ now() }}"

switch:
  - platform: template
    switches:
      plex:
        friendly_name: Plex
        value_template: >
                {% if states('media_player.nvidia_shield') in ['standby', 'idle', 'playing', 'paused']
                and is_state_attr('media_player.nvidia_shield','app_id','com.plexapp.android')
                and states('media_player.sony_kd_55xe9305') in ['on', 'playing', 'paused'] %}
                on
                {% else %}
                off
                {% endif %}
        turn_on:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command:
              - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
              - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - System Power
          - delay: 1
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - DTV
          - service: media_player.select_source
            target:
              entity_id: media_player.nvidia_shield
            data:
              source: "com.plexapp.android"
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
        turn_off:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - Standby
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
        icon_template: mdi:plex
      netflix:
        friendly_name: Netflix
        value_template: >
                {% if states('media_player.nvidia_shield') in ['standby', 'idle', 'playing', 'paused']
                and is_state_attr('media_player.nvidia_shield','app_id','com.netflix.ninja')
                and is_state('media_player.sony_kd_55xe9305', 'on') %}
                on
                {% else %}
                off
                {% endif %}
        turn_on:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command:
              - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
              - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - System Power
              - DTV
          - service: media_player.select_source
            target:
              entity_id: media_player.nvidia_shield
            data:
              source: "com.netflix.ninja"
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
        turn_off:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - Standby
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
        icon_template: mdi:netflix
      youtube:
        friendly_name: YouTube
        value_template: >
                {% if states('media_player.nvidia_shield') in ['standby', 'idle', 'playing', 'paused']
                and is_state_attr('media_player.nvidia_shield','app_id','com.google.android.youtube.tv')
                and is_state('media_player.sony_kd_55xe9305', 'on') %}
                on
                {% else %}
                off
                {% endif %}
        turn_on:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command:
              - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
              - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - System Power
              - DTV
          - service: media_player.select_source
            target:
              entity_id: media_player.nvidia_shield
            data:
              source: "com.google.android.youtube.tv"
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
        turn_off:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - Standby
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
        icon_template: mdi:youtube
      tv:
        friendly_name: TV
        value_template: >
                        {% if state_attr('media_player.sony_kd_55xe9305','source') in ['TVP1 HD', 'TVP2 HD', 'TVP3 Krakow', 'Polsat', 'TVN', 'TV4', 'TV Puls', 'TVN 7', 'PULS 2', 'TV6', 'Super Polsat', 'ESKA TV', 'TTV', 'Polo TV', 'SILVER TV', 'TV Trwam', 'Stopklatka TV', 'Fokus TV', 'TVP ABC', 'TVP Kultura HD', 'TVP Historia', 'TVP Sport HD', 'TVP Info', 'TVP Kobieta', 'Metro', 'Zoom TV', 'Nowa TV', 'WP', 'eSZKOLA DOMOWE PRZEDSZKOLE', 'Telewizja Naziemna', 'TVP Kultura 2', 'EmiTV', 'TOYAcyfrowaINFO'] %}
                          on
                          {% else %}
                          off
                          {% endif %}
        turn_on:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command:
              - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
              - Digital Analog
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - System Power
              - DTV
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
        turn_off:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - Standby
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
        icon_template: mdi:television
      radio:
        friendly_name: Radio
        value_template: "{{ is_state('input_boolean.radio_status','on') }}"
        turn_on:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
                - System Power
          - delay: 2
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
                - Tuner
          - service: input_boolean.turn_on
            target:
              entity_id: input_boolean.radio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
        turn_off:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - Standby
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
        icon_template: mdi:radio

      chromecast_audio:
        friendly_name: Chromecast Audio
        value_template: "{{ is_state('input_boolean.chromecast_audio_status','on') }}"
        turn_on:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
                - System Power
          - delay: 2
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
                - DVD
          - service: input_boolean.turn_on
            target:
              entity_id: input_boolean.chromecast_audio_status
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.radio_status
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: television
              command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
        turn_off:
          - service: remote.send_command
            data:
              entity_id: remote.rm4c_mini_remote
              device: Yamaha AVR
              command:
              - Standby
          - service: input_boolean.turn_off
            target:
              entity_id: input_boolean.chromecast_audio_status
        icon_template: mdi:cast-audio

script:
  turn_on_tv_for_shield:
    alias: Turn on TV for Shield
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
        - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - System Power
        - DTV
    mode: single
    icon: mdi:television
  set_hdmi3:
    alias: Turn on TV and set HDMI3 input
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
        - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
    mode: single
  turn_on_television:
    alias: Turn on television
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
        - Digital Analog
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - System Power
        - DTV
    mode: single
    icon: mdi:television-classic
  turn_on_tv_and_netflix:
    alias: Turn on TV and Netflix
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
        - Netflix
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - System Power
        - DTV
    mode: single
    icon: mdi:netflix
  turn_on_radio:
    alias: Turn on radio
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - System Power
        - Tuner
    - delay: 2
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Tuner
    mode: single
    icon: mdi:radio
  turn_off_tv_radio:
    alias: Turn off TV or Radio
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command: b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Standby
    mode: single
    icon: mdi:power-standby
  sony_tv_turn_on:
    alias: Sony TV Turn On
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
    mode: single
    icon: mdi:power
  sony_tv_turn_off:
    alias: Sony TV Turn off
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUcAE8TJxMnEycTJxMTEycTExMnExMTExMTExMAAy8NBQAAAAAAAAAAAAA=
    mode: single
    icon: mdi:power-off
  sony_tv_up:
    alias: Sony TV Up
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Up
    mode: restart
    icon: mdi:arrow-up-bold
  sony_tv_down:
    alias: Sony TV Down
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Down
    mode: restart
    icon: mdi:arrow-down-bold
  sony_tv_left:
    alias: Sony TV Left
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Left
    mode: restart
    icon: mdi:arrow-left-bold
  sony_tv_right:
    alias: Sony TV Right
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Right
    mode: restart
    icon: mdi:arrow-right-bold
  sony_tv_home:
    alias: Sony TV Home
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Home
    mode: single
    icon: mdi:home
  sony_tv_input:
    alias: Sony TV Input
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Input
    mode: single
    icon: mdi:video-input-hdmi
  sony_tv_number1:
    alias: Sony TV Number 1
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number1
    mode: single
    icon: mdi:numeric-1
  sony_tv_number2:
    alias: Sony TV Number 2
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number2
    mode: single
    icon: mdi:numeric-2
  sony_tv_number3:
    alias: Sony TV Number 3
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number3
    mode: single
    icon: mdi:numeric-3
  sony_tv_number4:
    alias: Sony TV Number 4
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number4
    mode: single
    icon: mdi:numeric-4
  sony_tv_number5:
    alias: Sony TV Number 5
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number5
    mode: single
    icon: mdi:numeric-5
  sony_tv_number6:
    alias: Sony TV Number 6
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number6
    mode: single
    icon: mdi:numeric-6
  sony_tv_number7:
    alias: Sony TV Number 7
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number7
    mode: single
    icon: mdi:numeric-7
  sony_tv_number8:
    alias: Sony TV Number 8
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number18
    mode: single
    icon: mdi:numeric-8
  sony_tv_number9:
    alias: Sony TV Number 9
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number9
    mode: single
    icon: mdi:numeric-9
  sony_tv_number0:
    alias: Sony TV Number 0
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Number0
    mode: single
    icon: mdi:numeric-0
  sony_tv_google_play:
    alias: Sony TV Google Play
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Google Play
    mode: single
    icon: mdi:google
  sony_tv_netflix:
    alias: Sony TV Netflix
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Netflix
    mode: single
    icon: mdi:netflix
  sony_tv_red:
    alias: Sony TV Red
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Red
    mode: single
    icon: mdi:palette
  sony_tv_green:
    alias: Sony TV Green
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Green
    mode: single
    icon: mdi:palette
  sony_tv_yellow:
    alias: Sony TV Yellow
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Yellow
    mode: single
    icon: mdi:palette
  sony_tv_blue:
    alias: Sony TV Blue
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Blue
    mode: single
    icon: mdi:palette
  sony_tv_action_menu:
    alias: Sony TV Action Menu
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Action Menu
    mode: single
    icon: mdi:dots-vertical
  sony_tv_tv:
    alias: Sony TV TV
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Digital Analog
    mode: single
    icon: mdi:television
  sony_tv_guide:
    alias: Sony TV Guide
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Guide
    mode: single
    icon: mdi:television-guide
  sony_tv_back:
    alias: Sony TV Back
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Back
    mode: single
    icon: mdi:keyboard-backspace
  sony_tv_discover:
    alias: Sony TV Discover
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Discover
    mode: single
    icon: mdi:newspaper
  sony_tv_volume_up:
    alias: Sony TV Volume Up
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Volume Up
    mode: restart
    icon: mdi:volume-plus
  sony_tv_volume_down:
    alias: Sony TV Volume Down
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Volume Down
    mode: restart
    icon: mdi:volume-minus
  sony_tv_channel_up:
    alias: Sony TV Channel Up
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Channel Up
    mode: single
    icon: mdi:arrow-up-bold-box
  sony_tv_channel_down:
    alias: Sony TV Channel Down
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Channel Down
    mode: single
    icon: mdi:arrow-down-bold-box
  sony_tv_mute:
    alias: Sony TV Mute
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Mute
    mode: single
    icon: mdi:volume-mute
  sony_tv_exit:
    alias: Sony TV Exit
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Exit
    mode: single
    icon: mdi:exit-to-app
  sony_tv_sync_menu:
    alias: Sony TV Sync Menu
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Sync Menu
    mode: single
    icon: mdi:sync-circle
  sony_tv_radio:
    alias: Sony TV Radio
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - TV Radio
    mode: single
    icon: mdi:radio
  sony_tv_enter:
    alias: Sony TV Enter
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Enter
    mode: single
    icon: mdi:location-enter
  sony_tv_audio:
    alias: Sony TV Audio
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Audio
    mode: single
    icon: mdi:audio-video
  sony_tv_play:
    alias: Sony TV Play
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Play
    mode: single
    icon: mdi:play
  sony_tv_stop:
    alias: Sony TV Stop
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Stop
    mode: single
    icon: mdi:stop
  sony_tv_pause:
    alias: Sony TV Pause
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Pause
    mode: single
    icon: mdi:pause
  sony_tv_fast_forward:
    alias: Sony TV Fast Forward
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Fast Forward
    mode: single
    icon: mdi:fast-forward
  sony_tv_fast_backward:
    alias: Sony TV Fast Backward
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Fast Backward
    mode: single
    icon: mdi:rewind
  sony_tv_previous:
    alias: Sony TV Previous
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Previous
    mode: single
    icon: mdi:skip-backward
  sony_tv_next:
    alias: Sony TV Next
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Next
    mode: single
    icon: mdi:skip-forward
  sony_tv_record:
    alias: Sony TV Record
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Record
    mode: single
    icon: mdi:record
  sony_tv_title_list:
    alias: Sony TV Title List
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Title List
    mode: single
    icon: mdi:subtitles
  sony_tv_help:
    alias: Sony TV Help
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Help
    mode: single
    icon: mdi:help
  sony_tv_info:
    alias: Sony TV Info
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Info
    mode: single
    icon: mdi:information
  sony_tv_text:
    alias: Sony TV Text
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Text
    mode: single
    icon: mdi:card-text
  sony_tv_subtitle:
    alias: Sony TV Subtitle
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Subtitle
    mode: single
    icon: mdi:subtitles
  sony_tv_jump:
    alias: Sony TV Jump
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - Jump
    mode: single
    icon: mdi:debug-step-over
  sony_tv_hdmi1:
    alias: Sony TV HDMI1
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUiAE8TExMnExMTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
    mode: single
    icon: mdi:video-input-hdmi
  sony_tv_hdmi2:
    alias: Sony TV HDMI2
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUiAE8TJxMnExMTJxMnExMTJxMTEycTExMnEycTExMTExMAApgNBQAAAAA=
    mode: single
    icon: mdi:video-input-hdmi
  sony_tv_hdmi3:
    alias: Sony TV HDMI3
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
    mode: single
    icon: mdi:video-input-hdmi
  sony_tv_hdmi4:
    alias: Sony TV HDMI4
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: television
        command:
        - b64:JgUiAE8TJxMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAApgNBQAAAAA=
    mode: single
    icon: mdi:video-input-hdmi
  yamaha_avr_power:
    alias: Yamaha AVR Power
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - System Power
    mode: single
    icon: mdi:power
  yamaha_avr_standby:
    alias: Yamaha AVR Standby
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Standby
    mode: single
    icon: mdi:power-standby
  yamaha_avr_cd:
    alias: Yamaha AVR CD
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - CD
    mode: single
    icon: mdi:disc
  yamaha_avr_md:
    alias: Yamaha AVR MD
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - MD
    mode: single
    icon: mdi:minidisc
  yamaha_avr_tuner:
    alias: Yamaha AVR Tuner
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Tuner
    mode: single
    icon: mdi:radio
  yamaha_avr_dvd:
    alias: Yamaha AVR DVD
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - DVD
    mode: single
    icon: mdi:disc-player
  yamaha_avr_dtv:
    alias: Yamaha AVR DTV
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - DTV
    mode: single
    icon: mdi:television-classic
  yamaha_avr_vcr:
    alias: Yamaha AVR VCR
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - VCR
    mode: single
    icon: mdi:vhs
  yamaha_avr_vaux:
    alias: Yamaha AVR VAUX
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - VAUX
    mode: single
    icon: mdi:video-input-svideo
  yamaha_avr_sleep:
    alias: Yamaha AVR Sleep
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Sleep
    mode: single
    icon: mdi:sleep
  yamaha_avr_multi_ch:
    alias: Yamaha AVR Multi Channel
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Multi Ch In
    mode: single
    icon: mdi:video-input-component
  yamaha_avr_volume_up:
    alias: Yamaha AVR Volume Up
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Volume Up
    mode: single
    icon: mdi:volume-plus
  yamaha_avr_volume_down:
    alias: Yamaha AVR Volume Down
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Volume Down
    mode: single
    icon: mdi:volume-minus
  yamaha_avr_number1:
    alias: Yamaha AVR Number 1
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number1
    mode: single
    icon: mdi:numeric-1
  yamaha_avr_number2:
    alias: Yamaha AVR Number 2
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number2
    mode: single
    icon: mdi:numeric-2
  yamaha_avr_number3:
    alias: Yamaha AVR Number 3
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number3
    mode: single
    icon: mdi:numeric-3
  yamaha_avr_number4:
    alias: Yamaha AVR Number 4
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number4
    mode: single
    icon: mdi:numeric-4
  yamaha_avr_number5:
    alias: Yamaha AVR Number 5
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number5
    mode: single
    icon: mdi:numeric-5
  yamaha_avr_number6:
    alias: Yamaha AVR Number 6
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number6
    mode: single
    icon: mdi:numeric-6
  yamaha_avr_number7:
    alias: Yamaha AVR Number 7
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number7
    mode: single
    icon: mdi:numeric-7
  yamaha_avr_number8:
    alias: Yamaha AVR Number 8
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Number8
    mode: single
    icon: mdi:numeric-8
  yamaha_avr_menu:
    alias: Yamaha AVR Menu
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Menu
    mode: single
    icon: mdi:menu
  yamaha_avr_up:
    alias: Yamaha AVR Up
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Up
    mode: single
    icon: mdi:arrow-up-bold
  yamaha_avr_down:
    alias: Yamaha AVR Down
    sequence:
    - service: remote.send_command
      data:
        entity_id: remote.rm4c_mini_remote
        device: Yamaha AVR
        command:
        - Down
    mode: single
    icon: mdi:arrow-down-bold
  nvidia_shield_key_power:
    alias: Nvidia Shield Key Power
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: POWER
    mode: single
    icon: mdi:power
  nvidia_shield_key_home:
    alias: Nvidia Shield Key Home
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: HOME
    mode: single
    icon: mdi:home
  nvidia_shield_key_sleep:
    alias: Nvidia Shield Key Sleep
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: SLEEP
    mode: single
    icon: mdi:sleep
  nvidia_shield_key_up:
    alias: Nvidia Shield Key Up
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: UP
    mode: single
    icon: mdi:arrow-up-bold
  nvidia_shield_key_down:
    alias: Nvidia Shield Key Down
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: DOWN
    mode: single
    icon: mdi:arrow-down-bold
  nvidia_shield_key_left:
    alias: Nvidia Shield Key Left
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: LEFT
    mode: single
    icon: mdi:arrow-left-bold
  nvidia_shield_key_right:
    alias: Nvidia Shield Key Right
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: RIGHT
    mode: single
    icon: mdi:arrow-right-bold
  nvidia_shield_key_center:
    alias: Nvidia Shield Key Center
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: CENTER
    mode: single
    icon: mdi:location-enter
  nvidia_shield_key_back:
    alias: Nvidia Shield Key Back
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: BACK
    mode: single
    icon: mdi:keyboard-backspace
  nvidia_shield_key_menu:
    alias: Nvidia Shield Key Menu
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: MENU
    mode: single
    icon: mdi:menu
  nvidia_shield_key_search:
    alias: Nvidia Shield Key Search
    sequence:
    - service: androidtv.adb_command
      data:
        entity_id: media_player.nvidia_shield
        command: SEARCH
    mode: single
    icon: mdi:magnify
  start_plex_on_nvidia_shield:
    alias: Start Plex on nVidia Shield
    sequence:
      - choose:
        #### If Plex is already open on the device, do nothing
        - conditions:
          - condition: template
            value_template: >-
              {{ states('media_player.nvidia_shield') in ['standby', 'idle', 'playing', 'paused']
                and is_state_attr('media_player.nvidia_shield','app_id','com.plexapp.android')
                and is_state('media_player.sony_kd_55xe9305', 'on') }}
          sequence: []
        default:
        #### If Plex isn't open on the device, open it
        #### You could even add a service to turn your TV on here
        - service: remote.send_command
          data:
            entity_id: remote.rm4c_mini_remote
            device: television
            command:
            - b64:JgUcAE8TExMnEycTJxMTEycTExMnExMTExMTExMAA0INBQAAAAAAAAAAAAA=
            - b64:JgUiAE8TExMTEycTJxMnExMTJxMTEycTExMnEycTExMTExMAAqYNBQAAAAA=
        - service: remote.send_command
          data:
            entity_id: remote.rm4c_mini_remote
            device: Yamaha AVR
            command:
            - System Power
        - delay:
            milliseconds: 500
        - service: remote.send_command
          data:
            entity_id: remote.rm4c_mini_remote
            device: Yamaha AVR
            command:
            - DTV
        - service: media_player.select_source
          target:
            entity_id: media_player.nvidia_shield
          data:
            source: "com.plexapp.android"
        - service: input_boolean.turn_off
          target:
            entity_id: input_boolean.radio_status
    mode: single
  radio:
    alias: Play Radio
    sequence:
    - service: media_player.volume_set
      data:
        volume_level: 0.5
      target:
        entity_id: >
          {% if is_state("input_select.player", "Google Nest") %} media_player.nest_mini
          {% elif is_state("input_select.player", "Chromecast Audio") %} media_player.chromecast_audio
          {% endif %}
    - service: media_player.play_media
      data:
        entity_id:
          '{% if is_state("input_select.player", "Google Nest") %} media_player.nest_mini
           {% elif is_state("input_select.player", "Chromecast Audio") %} media_player.chromecast_audio
           {% endif %}'
        media_content_id:
          '{% if is_state("input_select.radio_station", "Rock Radio") %} http://poznan5-4.radio.pionier.net.pl:8000/tuba8-1.mp3?DIST=TuneIn&TGT=TuneIn&maxServers=2&gdpr=1&us_privacy=1YNY&gdpr_consent=CPLe3S9PLe3S9AcABBENBmCgAAAAAAAAACiQAAAAAAJBIDYAGQAQAA0gCIAIoATABSgDvASIAvMBhoDDwGRAMkAZOAy4BnIDPgGkANOgawBrIDdYHIgcqA5cB0YDrAHjgPlCAFwGIAMWAZCAyMBkwDQgGjANKAamA2gBtwDdAHBAOkAdgA7MB3QDwIHkgeUA9oB7oD5AH2BoBgCKgEiAMPAYwAycBnIDPAGfAOSAcoA6wB-AYAMAyMBoQDdAHEgOzAe6IgEgJEAYeAycBnIDPgHJAOUAdYA_AQAFAaEA3QBxIDswHuioBgATAFNgLzAYeAyIBnIDPAGfANyAckA5QB-AoAIA0IBrwDiQH2DIBYATAF5gMPAZEAzkBngDPgHJAOUAfEA_AYADAaEA4kB9g6BaABkAEAANIAiACKAEwAL4AYgBSgDvAIsAXUBFQCRAF5gMNAYeAxIBjADHgGSAMnAZUAywBlwDOQGfANEgaQBpIDSwGnANVAawA2MBuoDi4HJAcqA5cB0YDrAHjgPSAeqA-UB9YD8BwBwAdwDEAGLAMhAZMAy8BoUDRQNGAaUA00BqYDXgG0ANsAbcA4mBx4HIAOkAdgA7MB4EDyQPKAe0A90B8QD7AH4gP2IQFwAMgBMAC-AGIAd4CRAGHgMSAZEAycBnIDPAGfANEAaSA0sBqoDgAHJAOjAdYA8cB-BAAcA0IBooDSgGpgNsAbcA4kB2EDyQPKAeiA90B8QD7AH7EoC4AGQAiABMAC-AGIAUoA7wC6gIqASIAvMBh4DIgGTgMsAZyAzwBnwDSAGsAOAAdYA_AkALAHcAxYBoQDSgG5AOJAdIA7AB5QD2gH2FIEIAGQAQAA0gCIAIoATAApABfADEAKUAd4BFgEiALzAYaAw8BjADIgGSAMnAZcAzkBngDPoGkAaTA1gDWQGxgN1gcmBygDlwHWAPHAfKA_AoAUAHcAXUBiwDJgGhANEAaUA02BqQGpgNeAcEA4kB2ADswHlAPaAe6A-IB9gD9gAA.YAAAAAAAAAAA&partnertok=eyJhbGciOiJIUzI1NiIsImtpZCI6InR1bmVpbiIsInR5cCI6IkpXVCJ9.eyJ0cnVzdGVkX3BhcnRuZXIiOnRydWUsImlhdCI6MTYyOTg3Njc3OSwiaXNzIjoidGlzcnYifQ.nZUJ1M-g7FY-Je7H-KIdEfs22ZfRfUnk_OXjz3l7iHI
           {% elif is_state("input_select.radio_station", "Antyradio") %} https://an.cdn.eurozet.pl/ant-waw.mp3?DIST=TuneIn&TGT=TuneIn&maxServers=2&gdpr=1&us_privacy=1YNY&gdpr_consent=CPLe3S9PLe3S9AcABBENBmCgAAAAAAAAACiQAAAAAAJBIDYAGQAQAA0gCIAIoATABSgDvASIAvMBhoDDwGRAMkAZOAy4BnIDPgGkANOgawBrIDdYHIgcqA5cB0YDrAHjgPlCAFwGIAMWAZCAyMBkwDQgGjANKAamA2gBtwDdAHBAOkAdgA7MB3QDwIHkgeUA9oB7oD5AH2BoBgCKgEiAMPAYwAycBnIDPAGfAOSAcoA6wB-AYAMAyMBoQDdAHEgOzAe6IgEgJEAYeAycBnIDPgHJAOUAdYA_AQAFAaEA3QBxIDswHuioBgATAFNgLzAYeAyIBnIDPAGfANyAckA5QB-AoAIA0IBrwDiQH2DIBYATAF5gMPAZEAzkBngDPgHJAOUAfEA_AYADAaEA4kB9g6BaABkAEAANIAiACKAEwAL4AYgBSgDvAIsAXUBFQCRAF5gMNAYeAxIBjADHgGSAMnAZUAywBlwDOQGfANEgaQBpIDSwGnANVAawA2MBuoDi4HJAcqA5cB0YDrAHjgPSAeqA-UB9YD8BwBwAdwDEAGLAMhAZMAy8BoUDRQNGAaUA00BqYDXgG0ANsAbcA4mBx4HIAOkAdgA7MB4EDyQPKAe0A90B8QD7AH4gP2IQFwAMgBMAC-AGIAd4CRAGHgMSAZEAycBnIDPAGfANEAaSA0sBqoDgAHJAOjAdYA8cB-BAAcA0IBooDSgGpgNsAbcA4kB2EDyQPKAeiA90B8QD7AH7EoC4AGQAiABMAC-AGIAUoA7wC6gIqASIAvMBh4DIgGTgMsAZyAzwBnwDSAGsAOAAdYA_AkALAHcAxYBoQDSgG5AOJAdIA7AB5QD2gH2FIEIAGQAQAA0gCIAIoATAApABfADEAKUAd4BFgEiALzAYaAw8BjADIgGSAMnAZcAzkBngDPoGkAaTA1gDWQGxgN1gcmBygDlwHWAPHAfKA_AoAUAHcAXUBiwDJgGhANEAaUA02BqQGpgNeAcEA4kB2ADswHlAPaAe6A-IB9gD9gAA.YAAAAAAAAAAA&partnertok=eyJhbGciOiJIUzI1NiIsImtpZCI6InR1bmVpbiIsInR5cCI6IkpXVCJ9.eyJ0cnVzdGVkX3BhcnRuZXIiOnRydWUsImlhdCI6MTYzMTM2NDQ2NCwiaXNzIjoidGlzcnYifQ.IvQ09BXx4eSdCHy7DWKhH9XhiGVIk0ruPZjP3G2XW7k
           {% elif is_state("input_select.radio_station", "RMF FM") %} http://www.rmfon.pl/tunein/tunein.php?host=rs203-krk.rmfstream.pl&mount=rmf_fm&secure=0&DIST=TuneIn&TGT=TuneIn&maxServers=2&gdpr=1&us_privacy=1YNY&gdpr_consent=CPLe3S9PLe3S9AcABBENBmCgAAAAAAAAACiQAAAAAAJBIDYAGQAQAA0gCIAIoATABSgDvASIAvMBhoDDwGRAMkAZOAy4BnIDPgGkANOgawBrIDdYHIgcqA5cB0YDrAHjgPlCAFwGIAMWAZCAyMBkwDQgGjANKAamA2gBtwDdAHBAOkAdgA7MB3QDwIHkgeUA9oB7oD5AH2BoBgCKgEiAMPAYwAycBnIDPAGfAOSAcoA6wB-AYAMAyMBoQDdAHEgOzAe6IgEgJEAYeAycBnIDPgHJAOUAdYA_AQAFAaEA3QBxIDswHuioBgATAFNgLzAYeAyIBnIDPAGfANyAckA5QB-AoAIA0IBrwDiQH2DIBYATAF5gMPAZEAzkBngDPgHJAOUAfEA_AYADAaEA4kB9g6BaABkAEAANIAiACKAEwAL4AYgBSgDvAIsAXUBFQCRAF5gMNAYeAxIBjADHgGSAMnAZUAywBlwDOQGfANEgaQBpIDSwGnANVAawA2MBuoDi4HJAcqA5cB0YDrAHjgPSAeqA-UB9YD8BwBwAdwDEAGLAMhAZMAy8BoUDRQNGAaUA00BqYDXgG0ANsAbcA4mBx4HIAOkAdgA7MB4EDyQPKAe0A90B8QD7AH4gP2IQFwAMgBMAC-AGIAd4CRAGHgMSAZEAycBnIDPAGfANEAaSA0sBqoDgAHJAOjAdYA8cB-BAAcA0IBooDSgGpgNsAbcA4kB2EDyQPKAeiA90B8QD7AH7EoC4AGQAiABMAC-AGIAUoA7wC6gIqASIAvMBh4DIgGTgMsAZyAzwBnwDSAGsAOAAdYA_AkALAHcAxYBoQDSgG5AOJAdIA7AB5QD2gH2FIEIAGQAQAA0gCIAIoATAApABfADEAKUAd4BFgEiALzAYaAw8BjADIgGSAMnAZcAzkBngDPoGkAaTA1gDWQGxgN1gcmBygDlwHWAPHAfKA_AoAUAHcAXUBiwDJgGhANEAaUA02BqQGpgNeAcEA4kB2ADswHlAPaAe6A-IB9gD9gAA.YAAAAAAAAAAA&partnertok=eyJhbGciOiJIUzI1NiIsImtpZCI6InR1bmVpbiIsInR5cCI6IkpXVCJ9.eyJ0cnVzdGVkX3BhcnRuZXIiOnRydWUsImlhdCI6MTYyOTg3ODQ2MCwiaXNzIjoidGlzcnYifQ.m-klf1WdJELmfhcNo607ecpUEwldP_G39cn5ykqWtO8
           {% elif is_state("input_select.radio_station", "RMF Classic") %} http://www.rmfon.pl/tunein/tunein.php?host=rs203-krk.rmfstream.pl&mount=rmf_classic&secure=0&DIST=TuneIn&TGT=TuneIn&maxServers=2&gdpr=1&us_privacy=1YNY&gdpr_consent=CPLe3S9PLe3S9AcABBENBmCgAAAAAAAAACiQAAAAAAJBIDYAGQAQAA0gCIAIoATABSgDvASIAvMBhoDDwGRAMkAZOAy4BnIDPgGkANOgawBrIDdYHIgcqA5cB0YDrAHjgPlCAFwGIAMWAZCAyMBkwDQgGjANKAamA2gBtwDdAHBAOkAdgA7MB3QDwIHkgeUA9oB7oD5AH2BoBgCKgEiAMPAYwAycBnIDPAGfAOSAcoA6wB-AYAMAyMBoQDdAHEgOzAe6IgEgJEAYeAycBnIDPgHJAOUAdYA_AQAFAaEA3QBxIDswHuioBgATAFNgLzAYeAyIBnIDPAGfANyAckA5QB-AoAIA0IBrwDiQH2DIBYATAF5gMPAZEAzkBngDPgHJAOUAfEA_AYADAaEA4kB9g6BaABkAEAANIAiACKAEwAL4AYgBSgDvAIsAXUBFQCRAF5gMNAYeAxIBjADHgGSAMnAZUAywBlwDOQGfANEgaQBpIDSwGnANVAawA2MBuoDi4HJAcqA5cB0YDrAHjgPSAeqA-UB9YD8BwBwAdwDEAGLAMhAZMAy8BoUDRQNGAaUA00BqYDXgG0ANsAbcA4mBx4HIAOkAdgA7MB4EDyQPKAe0A90B8QD7AH4gP2IQFwAMgBMAC-AGIAd4CRAGHgMSAZEAycBnIDPAGfANEAaSA0sBqoDgAHJAOjAdYA8cB-BAAcA0IBooDSgGpgNsAbcA4kB2EDyQPKAeiA90B8QD7AH7EoC4AGQAiABMAC-AGIAUoA7wC6gIqASIAvMBh4DIgGTgMsAZyAzwBnwDSAGsAOAAdYA_AkALAHcAxYBoQDSgG5AOJAdIA7AB5QD2gH2FIEIAGQAQAA0gCIAIoATAApABfADEAKUAd4BFgEiALzAYaAw8BjADIgGSAMnAZcAzkBngDPoGkAaTA1gDWQGxgN1gcmBygDlwHWAPHAfKA_AoAUAHcAXUBiwDJgGhANEAaUA02BqQGpgNeAcEA4kB2ADswHlAPaAe6A-IB9gD9gAA.YAAAAAAAAAAA&partnertok=eyJhbGciOiJIUzI1NiIsImtpZCI6InR1bmVpbiIsInR5cCI6IkpXVCJ9.eyJ0cnVzdGVkX3BhcnRuZXIiOnRydWUsImlhdCI6MTYyOTg3ODQ2MCwiaXNzIjoidGlzcnYifQ.m-klf1WdJELmfhcNo607ecpUEwldP_G39cn5ykqWtO8
           {% elif is_state("input_select.radio_station", "Nowy Świat") %} http://stream.rcs.revma.com/ypqt40u0x1zuv
           {% endif %}'
        media_content_type: 'audio/mp4'
        extra:
          thumb:
            '{% if is_state("input_select.radio_station", "Rock Radio") %} https://ha.anarion.pl/local/radio_covers/rockradio.jpg
             {% elif is_state("input_select.radio_station", "Antyradio") %} https://ha.anarion.pl/local/radio_covers/antyradio.png
             {% elif is_state("input_select.radio_station", "RMF FM") %} https://ha.anarion.pl/local/radio_covers/RMF-FM-logo.png
             {% elif is_state("input_select.radio_station", "RMF Classic") %} https://ha.anarion.pl/local/radio_covers/RMF_classic.png
             {% elif is_state("input_select.radio_station", "Nowy Świat") %} https://ha.anarion.pl/local/radio_covers/nowy-swiat.jpg
             {% endif %}'
    mode: single